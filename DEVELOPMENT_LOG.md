# üìù Development Log: CSV Import System

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-16  
**–ó–∞–¥–∞—á–∞:** –°–∏—Å—Ç–µ–º–∞ –∏–º–ø–æ—Ä—Ç–∞ –ø—Ä–∞–π—Å–∞ –∏–∑ CSV –≤ —Ç–∞–±–ª–∏—Ü—É `price_items`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV-—Ñ–∞–π–ª–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö MySQL —á–µ—Ä–µ–∑ Drizzle ORM.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

- ‚ùå –ù–ï –º–µ–Ω—è—Ç—å —Å—Ö–µ–º—É –ë–î
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `attrs` (electrical, mechanical, compat, bos, meta)
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –º–∞–ø–ø–∏–Ω–≥–∞ –∏–∑ Excel-–∏–º–ø–æ—Ä—Ç–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ UPSERT (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π –ø–æ `sku`)
- ‚úÖ –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –æ—à–∏–±–∫–∞–º (–Ω–µ –ø–∞–¥–∞—Ç—å –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ)
- ‚úÖ Stream-–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

---

## üì¶ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### üõ†Ô∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (3 —Ñ–∞–π–ª–∞)

1. **`scripts/csvImportHelpers.js`** (183 —Å—Ç—Ä–æ–∫–∏)

   - –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞: `toNum()`, `toInt()`, `toBool()`
   - –ü–∞—Ä—Å–∏–Ω–≥ –Ω–∞–ª–∏—á–∏—è –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞: `parseStockFlag()`, `parsePriority()`
   - –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã: `parseGridType()`, `parseBatterySupport()`
   - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π UPSERT: `upsertPriceItem()`
   - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç: `importFromCsv()` ‚Äî –∫–∞—Ä–∫–∞—Å –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π

2. **`scripts/importFromCsv.TEMPLATE.js`** (115 —Å—Ç—Ä–æ–∫)

   - –®–∞–±–ª–æ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
   - –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
   - –ó–∞–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `attrs`

3. **`scripts/README_CSV_IMPORT.md`** (–≥–ª–∞–≤–Ω–æ–µ –æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ)
   - –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
   - –ë—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
   - –ö–∞—Ä—Ç–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –ì–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏–º–ø–æ—Ä—Ç–∞ (3 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)

1. **`scripts/importInvertersFromCsv.js`** (115 —Å—Ç—Ä–æ–∫)

   - –ö–∞—Ç–µ–≥–æ—Ä–∏—è: `inverter`
   - CSV: `./data/PRICE_INVERTERS.csv`
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `attrs`: electrical (7 –ø–æ–ª–µ–π) + compat (7 –ø–æ–ª–µ–π) + bos (6 –ø–æ–ª–µ–π) + meta (4 –ø–æ–ª—è)

2. **`scripts/importModulesFromCsv.js`** (111 —Å—Ç—Ä–æ–∫)

   - –ö–∞—Ç–µ–≥–æ—Ä–∏—è: `panel`
   - CSV: `./data/PRICE_MODULES.csv`
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `attrs`: electrical (7 –ø–æ–ª–µ–π) + mechanical (5 –ø–æ–ª–µ–π) + compat (7 –ø–æ–ª–µ–π) + bos (2 –ø–æ–ª—è) + meta (7 –ø–æ–ª–µ–π)

3. **`scripts/importEssFromCsv.js`** (102 —Å—Ç—Ä–æ–∫–∏)
   - –ö–∞—Ç–µ–≥–æ—Ä–∏—è: `ess`
   - CSV: `./data/PRICE_ESS.csv`
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `attrs`: electrical (7 –ø–æ–ª–µ–π) + compat (6 –ø–æ–ª–µ–π) + bos (4 –ø–æ–ª—è) + meta (7 –ø–æ–ª–µ–π)

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (5 —Ñ–∞–π–ª–æ–≤)

1. **`CSV_IMPORT_QUICKSTART.md`** (–∫–æ—Ä–µ–Ω—å, 175 —Å—Ç—Ä–æ–∫)

   - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∑–∞ 5 –º–∏–Ω—É—Ç
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞, –∑–∞–ø—É—Å–∫
   - –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

2. **`scripts/CSV_IMPORT_README.md`** (275 —Å—Ç—Ä–æ–∫)

   - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `attrs` –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
   - –ü—Ä–∏–º–µ—Ä—ã –ø–æ–ª–µ–π
   - –ß–µ–∫–ª–∏—Å—Ç—ã –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

3. **`scripts/CSV_IMPORT_COMMANDS.md`** (245 —Å—Ç—Ä–æ–∫)

   - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
   - –¢–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è CSV ‚Üí –ö–∞—Ç–µ–≥–æ—Ä–∏—è
   - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ (–ø–æ—à–∞–≥–æ–≤–æ)
   - –ú–∞—Å—Å–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

4. **`scripts/EXAMPLES.md`** (385 —Å—Ç—Ä–æ–∫)

   - 9 –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –±–∞—Ç–∞—Ä–µ–π (–ø–æ—à–∞–≥–æ–≤–æ)
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–π—Å–∞
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ cron
   - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

5. **`CSV_IMPORT_SUMMARY.md`** (–∫–æ—Ä–µ–Ω—å, 220 —Å—Ç—Ä–æ–∫)
   - –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `attrs` –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
   - –ö–∞—Ä—Ç–∞ —Ñ–∞–π–ª–æ–≤
   - –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞                      | –ó–Ω–∞—á–µ–Ω–∏–µ                          |
| ---------------------------- | --------------------------------- |
| **–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤**             | 11                                |
| **–†–∞–±–æ—á–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤**         | 3 (inverter, panel, ess)          |
| **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –º–æ–¥—É–ª–µ–π** | 2                                 |
| **–î–æ–∫—É–º–µ–Ω—Ç–æ–≤**               | 5                                 |
| **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞**               | ~700                              |
| **–°—Ç—Ä–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**       | ~1300                             |
| **–ö–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è** | 3 (–≥–æ—Ç–æ–≤–æ) + —à–∞–±–ª–æ–Ω –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö |

---

## üîë –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

### 1. Stream-–æ–±—Ä–∞–±–æ—Ç–∫–∞ CSV

```javascript
const parser = createReadStream(csvPath).pipe(
  parse({
    columns: true,
    skip_empty_lines: true,
    trim: true,
    bom: true,
    encoding: "utf8",
  })
);

for await (const row of parser) {
  // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- –ù–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤–µ—Å—å —Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç—å
- –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ RAM
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ñ–∞–π–ª–æ–≤ –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

### 2. UPSERT —á–µ—Ä–µ–∑ raw SQL

```sql
INSERT INTO price_items (...) VALUES (...)
ON DUPLICATE KEY UPDATE
  price_rub = VALUES(price_rub),
  attrs = VALUES(attrs),
  ...
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
- –ê—Ç–æ–º–∞—Ä–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (–Ω–µ –Ω—É–∂–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ MySQL/MariaDB

### 3. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞

```javascript
await importFromCsv({
  csvPath,
  categoryCode,
  categoryName,
  mapRowToPriceItem,
  db,
  schema,
});
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- DRY: –∫–æ–¥ –Ω–µ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é (3 –º–∏–Ω—É—Ç—ã)
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `attrs`

```javascript
const attrs = {
  electrical: { ... },
  mechanical: { ... },
  compat: { ... },
  bos: { ... },
  meta: { ... }
};
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å Excel-–∏–º–ø–æ—Ä—Ç–æ–º
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ö–µ–º—ã –ë–î
- –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è

---

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (flow)

```
1. –ó–∞–ø—É—Å–∫: node scripts/importInvertersFromCsv.js
           ‚Üì
2. –ß—Ç–µ–Ω–∏–µ: createReadStream('./data/PRICE_INVERTERS.csv')
           ‚Üì
3. –ü–∞—Ä—Å–∏–Ω–≥: csv-parse (–ø–æ—Å—Ç—Ä–æ—á–Ω–æ)
           ‚Üì
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: SELECT FROM price_categories WHERE code = 'inverter'
           ‚Üì
5. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:
   ‚îú‚îÄ –í–∞–ª–∏–¥–∞—Ü–∏—è: –µ—Å—Ç—å –ª–∏ SKU –∏ –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ?
   ‚îú‚îÄ –ú–∞–ø–ø–∏–Ω–≥: mapInverterRowToPriceItem(row, categoryId)
   ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–∞: SELECT FROM price_items WHERE sku = ?
   ‚îú‚îÄ UPSERT: INSERT ... ON DUPLICATE KEY UPDATE
   ‚îî‚îÄ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–æ / üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–æ
           ‚Üì
6. –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç:
   ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: 42
   üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–æ: 13
   ‚ö†Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ: 2
```

---

## üîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Excel-–∏–º–ø–æ—Ä—Ç–æ–º

| –ö—Ä–∏—Ç–µ—Ä–∏–π            | Excel                     | CSV                 | –í—ã–∏–≥—Ä—ã—à       |
| ------------------- | ------------------------- | ------------------- | ------------- |
| **–°–∫–æ—Ä–æ—Å—Ç—å**        | ~1000 —Å—Ç—Ä–æ–∫/–º–∏–Ω           | ~3000 —Å—Ç—Ä–æ–∫/–º–∏–Ω     | üöÄ 3x         |
| **–ü–∞–º—è—Ç—å**          | –í–µ—Å—å —Ñ–∞–π–ª –≤ RAM           | Stream              | üéØ –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è |
| **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞**    | –î–æ 10 –ú–ë                  | –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω         | ‚ôæÔ∏è            |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**     | xlsx (–±–æ–ª—å—à–∞—è)            | csv-parse (–ª—ë–≥–∫–∞—è)  | üì¶ –ú–µ–Ω—å—à–µ     |
| **CI/CD**           | –°–ª–æ–∂–Ω–æ (Excel –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ) | –õ–µ–≥–∫–æ               | ‚úÖ            |
| **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ attrs** | ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞           | ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞     | =             |
| **–õ–æ–≥–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞** | ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞       | ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ | =             |

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç

```bash
node scripts/importInvertersFromCsv.js
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∞ –¥–ª—è –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

```bash
# 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω
cp scripts/importFromCsv.TEMPLATE.js scripts/importBattFromCsv.js

# 2. –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (CSV_PATH, CATEGORY_CODE, TYPE_CODE)
# 3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –º–∞–ø–ø–∏–Ω–≥–∞ –∏–∑ scripts/importBatt.js
# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å
node scripts/importBattFromCsv.js
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–π—Å–∞

```bash
# –ó–∞–º–µ–Ω–∏—Ç—å CSV –Ω–æ–≤—ã–º —Ñ–∞–π–ª–æ–º
mv –Ω–æ–≤—ã–π_–ø—Ä–∞–π—Å.csv ./data/PRICE_INVERTERS.csv

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç —Ü–µ–Ω—ã)
node scripts/importInvertersFromCsv.js
```

---

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Node.js** ‚Äî runtime
- **csv-parse** ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ CSV (stream)
- **Drizzle ORM** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ë–î
- **MySQL** ‚Äî –ë–î (ON DUPLICATE KEY UPDATE)
- **ES Modules** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

---

## üìö –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. –°—Ç–∞—Ä—Ç: **[CSV_IMPORT_QUICKSTART.md](CSV_IMPORT_QUICKSTART.md)**
2. –°–ø—Ä–∞–≤–∫–∞: **[scripts/CSV_IMPORT_COMMANDS.md](scripts/CSV_IMPORT_COMMANDS.md)**

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

1. –ü—Ä–∏–º–µ—Ä—ã: **[scripts/EXAMPLES.md](scripts/EXAMPLES.md)**
2. –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: **[scripts/CSV_IMPORT_README.md](scripts/CSV_IMPORT_README.md)**

### –ì–ª–∞–≤–Ω–æ–µ –æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- **[scripts/README_CSV_IMPORT.md](scripts/README_CSV_IMPORT.md)**

---

## ‚úÖ –ß—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å

- [x] –ò–º–ø–æ—Ä—Ç –∏–Ω–≤–µ—Ä—Ç–æ—Ä–æ–≤ –∏–∑ CSV
- [x] –ò–º–ø–æ—Ä—Ç –ø–∞–Ω–µ–ª–µ–π –∏–∑ CSV
- [x] –ò–º–ø–æ—Ä—Ç ESS –∏–∑ CSV
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π (UPSERT)
- [x] –°–æ–∑–¥–∞–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∞ –¥–ª—è –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞ 3 –º–∏–Ω—É—Ç—ã

---

## üöÄ –ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –±—É–¥—É—â–µ–º

- [ ] –ò–º–ø–æ—Ä—Ç –±–∞—Ç–∞—Ä–µ–π (`importBattFromCsv.js`)
- [ ] –ò–º–ø–æ—Ä—Ç –º–æ–Ω—Ç–∞–∂–∞ –∏ BOS (`importMountBosFromCsv.js`)
- [ ] –ú–∞—Å—Å–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (`importAllFromCsv.js`)
- [ ] –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤ –≤ CSV/JSON
- [ ] Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞

---

## üéì –£—Ä–æ–∫–∏ –∏ –≤—ã–≤–æ–¥—ã

### –ß—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª–æ —Ö–æ—Ä–æ—à–æ:

‚úÖ **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ Excel-–∏–º–ø–æ—Ä—Ç–∞** ‚Äî –Ω–µ –ø—Ä–∏—à–ª–æ—Å—å –ø–∏—Å–∞—Ç—å –º–∞–ø–ø–∏–Ω–≥ —Å –Ω—É–ª—è  
‚úÖ **–®–∞–±–ª–æ–Ω** ‚Äî –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∑–∞ –º–∏–Ω—É—Ç—ã  
‚úÖ **Stream-–æ–±—Ä–∞–±–æ—Ç–∫–∞** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ —Ñ–∞–π–ª–æ–≤  
‚úÖ **UPSERT** ‚Äî –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã  
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** ‚Äî 5 —Ñ–∞–π–ª–æ–≤ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ –ø–æ—à–∞–≥–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

### –°–ª–æ–∂–Ω–æ—Å—Ç–∏:

‚ö†Ô∏è Drizzle ORM –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `ON DUPLICATE KEY UPDATE` –Ω–∞—Ç–∏–≤–Ω–æ ‚Üí –ø—Ä–∏—à–ª–æ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å raw SQL  
‚ö†Ô∏è –í–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `attrs` —Å Excel-–∏–º–ø–æ—Ä—Ç–æ–º ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

## üìä –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

- [x] –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ (`csvImportHelpers.js`)
- [x] –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞
- [x] –®–∞–±–ª–æ–Ω –¥–ª—è –Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π

### –ì–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

- [x] –ò–Ω–≤–µ—Ä—Ç–æ—Ä—ã (`importInvertersFromCsv.js`)
- [x] –ü–∞–Ω–µ–ª–∏ (`importModulesFromCsv.js`)
- [x] ESS (`importEssFromCsv.js`)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [x] –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –º–∏–Ω—É—Ç)
- [x] –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] –ü—Ä–∏–º–µ—Ä—ã (9 –∫–µ–π—Å–æ–≤)
- [x] –ö–æ–º–∞–Ω–¥—ã –∏ —á–µ–∫–ª–∏—Å—Ç—ã
- [x] –ì–ª–∞–≤–Ω–æ–µ –æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–∞ (no errors)
- [x] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `attrs` –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞ —Å Excel
- [x] –í—Å–µ –ø—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—á–∏–µ

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ production  
**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-01-16

**–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É:** [CSV_IMPORT_QUICKSTART.md](CSV_IMPORT_QUICKSTART.md)
